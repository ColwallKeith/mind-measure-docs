# Marketing Sites Architecture

## System Overview

Marketing sites use a **design-led, content-unified** architecture:

1. **Figma** – Page layouts and design system
2. **Marketing CMS** – Blog and article content (single source for marketing sites + mobile app)
3. **Marketing Sites** – Static pages from Figma + dynamic blog from CMS API

## Domain Structure

| Domain | Type | Purpose | Repository |
|--------|------|---------|------------|
| **mindmeasure.co.uk** | Marketing | University/Institution site | mindmeasure-marketing or Figma Make output |
| **mindmeasure.app** | Marketing | Student site | mindmeasure-marketing or Figma Make output |
| **marketing.mindmeasure.co.uk** | Marketing CMS | Content management | mind-measure-marketing-cms |
| **admin.mindmeasure.co.uk** | Admin | Admin dashboard, University CMS | mind-measure-core |
| **mobile.mindmeasure.app** | Mobile App | Student mobile app | mind-measure-mobile-final |

## Data Flow

### Page Layouts (Static)

```
Figma Design → Figma Make (React) or Hand-Code → React Components → Build → Vercel CDN
```

- Home, About, Contact, How it works, The science, etc.
- No CMS for structure – design drives implementation

### Blog Content (Dynamic)

```
Content Editor → Marketing CMS → Publish
                                    │
                    ┌───────────────┼───────────────┐
                    ▼               ▼               ▼
            marketing.co.uk   mindmeasure.app   mobile.mindmeasure.app
            (via public API)  (via public API)  (via University deployments)
```

### Content Reuse

- **Blog post** created in Marketing CMS with `targetSites: ['university', 'student']`
- **Marketing sites** fetch published posts at build time via `GET /api/public/blog-posts?site=university`
- **Mobile app** receives same content when a university deploys it to their app via University CMS

## Marketing CMS

- **Repository:** [github.com/Mind-Measure/mind-measure-marketing-cms](https://github.com/Mind-Measure/mind-measure-marketing-cms)
- **Deployed at:** marketing.mindmeasure.co.uk
- **Stack:** Next.js, Prisma, PostgreSQL, S3

### Content Types

| Type | Use |
|------|-----|
| **Blog posts** | Marketing blog pages + mobile app articles |
| **Pages** | (Optional) Page content if not fully static from Figma |
| **Media** | Images for blog posts and pages |

### Public API (Required for Marketing Sites)

- `GET /api/public/blog-posts?site=university|student|pro`
- `GET /api/public/blog-posts/[slug]`
- `GET /api/public/pages?site=...` (if using CMS for pages)

These endpoints are read-only, return only PUBLISHED content, and require no authentication.

## Figma Workflow

1. **Design** – Create page layouts in Figma (shared design system)
2. **Export** – Figma Make generates code, or developers hand-code from designs
3. **Integrate** – React components used in marketing site
4. **Deploy** – Static pages go live on Vercel

Figma is the source of truth for layout, typography, spacing, and visual structure.

## Build Process

1. **Code push** – Developer pushes to GitHub
2. **Vercel build** – Triggers on push (or webhook from CMS)
3. **Fetch content** – Build fetches published posts from Marketing CMS public API
4. **Generate pages** – Static pages from code + blog pages from API data
5. **Deploy** – Output deployed to Vercel edge network

## Deprecated: Sanity

- **Previous role:** Page structure, nav, footer, blog
- **Replaced by:** Figma (pages) + Marketing CMS (blogs)
- **Action:** Migrate any remaining content; remove Sanity from marketing sites

---

**Architecture Version:** 2.0  
**Last Updated:** January 2026
